(function(){"use strict";{void 0===window.ssurade&&(window.ssurade={});let e=[];window.open=function(t){for(let n of e)n(t);e=[]};let t=[];window.URL.createObjectURL=function(e){throw e instanceof Blob?(e.arrayBuffer().then((e=>{let n=new TextDecoder("utf-16le",{ignoreBOM:!0,fatal:!1}).decode(e);for(let e of t)e(n);t=[]})),new Error):new Error};class n{waitForElement=async(e,t={interval:10,maxTry:500,failFunc:()=>{}})=>{t=Object.assign({interval:10,maxTry:500,failFunc:()=>{}},t);let{interval:n,maxTry:s,failFunc:o}=t;for(let t=0;t<s&&!e();t++){if(t+1===s)return!1;await new Promise((e=>setTimeout(e,n))),o()}return!0};waitForOpen=()=>new Promise((t=>{e.push(t)}));waitForDownload=()=>new Promise((e=>{t.push(e)}))}ssurade.domUtils=new n}{void 0===window.ssurade&&(window.ssurade={}),void 0===window.ssurade.flutter&&(window.ssurade.flutter={}),window.ssurade.flutter.sendMessage=function(){console.log(...arguments)},window.addEventListener("message",(function(event){if("ssurade"===event.data){let port=event.ports[0];port.onmessage=async ev=>{let p=await eval(ev.data);port.postMessage(JSON.stringify({data:p}))}}}));let promises=[];promises.push(new Promise((e=>{window.flutter_inappwebview?._platformReady?e():window.addEventListener("flutterInAppWebViewPlatformReady",e)}))),promises.push(new Promise((e=>{ssurade?.init?e():window.addEventListener("ssurade_lightspeed",e)})));const init=()=>{null!==window.flutter_inappwebview?.callHandler&&(window.ssurade.flutter.sendMessage=window.flutter_inappwebview.callHandler),ssurade.flutter.sendMessage("load")};Promise.all(promises).then(init)}(async()=>{if(void 0===window.ssurade&&(window.ssurade={}),await new Promise((e=>{"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",e)})),void 0===window.UCF_LS)return window.ssurade.init=!0,void window.dispatchEvent(new Event("ssurade_lightspeed"));{let e;await new Promise((t=>e=setInterval((()=>{null!==window.application&&window.application.lightspeed&&(t(),clearInterval(e))}),1)))}let e=!1,t=application.lightspeed.lock;application.lightspeed.lock=function(){let n=t.call(this,...arguments);return e=!0,n};let n=application.lightspeed.unlock,s=[];application.lightspeed.unlock=function(){let t=n.call(this,...arguments);return setTimeout((()=>{for(let e of s)e();s=[],e=!1}),0),ssurade.lightspeed.update(),t};window.ssurade.lightspeed=new class{update=()=>{Array(...document.querySelectorAll("*[id^='WD']")).forEach((e=>application.lightspeed.oControlFactory.oGetControlById(e.id)))};waitForUnlock=()=>{let t,n;return t=new Promise((e=>n=e)),e?s.push(n):n(),t};waitForPageLoad=async()=>new Promise((e=>{let t=setInterval((()=>{UCF_LS._.lock>=1&&(clearInterval(t),this.waitForUnlock().then(e))}))}));findElement=e=>(ssurade.lightspeed.update(),Object.values(application.lightspeed.oControlFactory.mControls).find(e));findElementById=e=>application.lightspeed.oControlFactory.oGetControlById(e);getInput=e=>this.findElementById(this.findElement((t=>"label"===t.oDomRef.tagName.toLowerCase()&&t.sText===e))?.oDomRef?.htmlFor);clickButton=async e=>{let t=this.findElement((t=>t.sText===e&&"VISIBLE"===t.sVisibility));if(void 0!==t)return t.firePress(t.sId),this.waitForUnlock()};parseTable=(e,t)=>{let n={},s=this.findElement(e);{let e=s.aGetCellInfosOfRow(0);for(let s=0;s<e.length;s++){let o=e[s].oDomRefCell.innerText;for(let e in t)t[e]===o&&(n[e]=s)}}let o=[];for(let e=1;e<=s.iRowCount;e++){let t=s.aGetCellInfosOfRow(e),a={};for(let e in n)a[e]=t[n[e]].oDomRefCell.innerText.trim();o.push(a)}return o};closePopup=()=>this.clickButton("닫기")},window.ssurade.init=!0,window.dispatchEvent(new Event("ssurade_lightspeed"))})(),void 0===window.ssurade&&(window.ssurade={}),void 0===window.ssurade.crawl&&(window.ssurade.crawl={}),window.ssurade.crawl.getSingleGrade=async(e,t,n)=>{let s=window.ssurade.lightspeed;await s.waitForPageLoad();await s.closePopup(),s.getInput("학년도").setValue(e),await s.waitForUnlock();await s.closePopup(),s.getInput("학기").setValue(t),await s.waitForUnlock();let o={};return o.subjects=s.parseTable((e=>"학기별 세부 성적"===e.sTitleText),{subject_name:"과목명",subject_code:"과목코드",credit:"과목학점",grade_score:"성적",grade_symbol:"등급",professor:"교수명"}),o.rank=s.parseTable((e=>"학기별 성적"===e.sTitleText),{year:"학년도",semester:"학기",semester_rank:"학기별석차",total_rank:"전체석차"}).find((t=>t.year===e&&t.semester===n)),o},void 0===window.ssurade&&(window.ssurade={}),void 0===window.ssurade.crawl&&(window.ssurade.crawl={}),window.ssurade.crawl.getGradeFromViewer=async()=>{if("office.ssu.ac.kr"!==location.hostname)return null;if(!await ssurade.domUtils.waitForElement((()=>null!==document.querySelector("input[tabindex='4']"))))return null;document.querySelector("input[tabindex='4']").click();if(!await ssurade.domUtils.waitForElement((()=>document.querySelectorAll("select").length>=3),{failFunc:()=>document.querySelector("input[tabindex='4']").click()}))return null;document.querySelectorAll("select")[1].selectedIndex=6,document.querySelectorAll("select")[1].dispatchEvent(new Event("change")),document.querySelectorAll("select")[1].closest("tr").querySelector("input").value="|||||",document.querySelectorAll("select")[2].selectedIndex=1,document.querySelectorAll("select")[2].dispatchEvent(new Event("change"));let e=ssurade.domUtils.waitForDownload();return document.querySelector("button[classname='confirmButtonClass']").click(),e},void 0===window.ssurade&&(window.ssurade={}),void 0===window.ssurade.crawl&&(window.ssurade.crawl={}),window.ssurade.crawl.getStudentInfo=async()=>{let e=window.ssurade.lightspeed;return await e.waitForPageLoad(),[ssurade.lightspeed.getInput("입학 년도").getValue(),ssurade.lightspeed.getInput("졸업년도").getValue()]},void 0===window.ssurade&&(window.ssurade={}),void 0===window.ssurade.crawl&&(window.ssurade.crawl={}),window.ssurade.crawl.getGradeViewerURL=async()=>{let e=window.ssurade.lightspeed;await e.waitForPageLoad();let t=ssurade.domUtils.waitForOpen();return await e.clickButton("이수구분별 성적현황 출력"),await e.waitForUnlock(),t}})();
